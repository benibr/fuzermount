FROM rockylinux:9

RUN dnf -y install fuse3 gcc

COPY test/fusermount3 /opt/fuzermount/fusermount3
COPY test/dfuse.c /tmp/dfuse.c
# shall be overwritten when testing
COPY fuzermount /opt/fuzermount/fuzermount

RUN ln -sf /opt/fuzermount/fuzermount /usr/bin/fusermount3

RUN gcc -O2 -o /usr/bin/dfuse /tmp/dfuse.c
